# TicketsWinner

TicketsWinner是一款专门用于抢付航脱口秀门票的软件，为对抗黄牛而查阅资料进行整合，仅自用，严禁商用以及一切非法用途！！！

## 环境部署

### 1. 安装Python，并配置环境变量

参考：https://blog.csdn.net/2401_83413238/article/details/145422332?fromshare=blogdetail&sharetype=blogdetail&sharerId=145422332&sharerefer=PC&sharesource=Joeyeah_ibbbbbbb&sharefrom=from_link

### 2. 安装fiddler,并在tools中设置允许抓包https

参考：https://blog.csdn.net/qq_39720249/article/details/81069929

## 结构介绍

### 1. tickets_winner.py

- 抢票脚本，运行后自动抢票
- 抢票成功后手动支付
- 抢票失败后自动重试

> 脚本主要分为四部分：
> 请求1. 获取front-trace-id
> 请求2. 获取抢票预填信息
> 请求3. 获取抢票信息
> 请求4. 抢票
> 脚本运行时会自动获取预填信息，无需手动填写

## 使用方法

### 1. **抢票前2小时**

- **获取新access_token**：
    - 打开Fiddler抓包工具（确保已配置好HTTPS抓包）
    - 在PC微信中进入付航脱口秀小程序，**重新登录账号**
    - 点击进入「选择场次/座位」页面（不要提交）
    - 在Fiddler中按`Ctrl+F`搜索`access-token`
    - 复制最新token值替换脚本中的：
      ```python
      access_token = '<KEY>'
      ```

### 2. **抢票前30分钟**

- **环境检查**：
    - 关闭Fiddler和其他占用网络的软件（如迅雷、网盘）
    - 确保电脑连接**有线网络**（WiFi稳定性较差）
    - 关闭系统自动更新/杀毒软件（防止意外中断）
    - 测试脚本是否能正常运行：
      ```bash
      python main.py
      ```
      确认输出`>>>>>获取预填信息成功>>>>>`

### 3. **抢票前15分钟**

- **启动准备**：
    - 修改脚本中的时间参数（如果抢票时间有变动）：
      ```python
      start_time = '18:00:00'  # 与实际开抢时间一致
      ```
    - 建议将`max_requests_times`调至200-300次：

### 4. **抢票前5分钟**

- **正式运行脚本**：

#### 5. **抢票瞬间（关键！）**

- **紧急情况处理**：
    - 如果控制台卡住，**不要关闭程序**！可能是服务器高并发响应慢
    - 看到`>>>>>>抢票成功！<<<<<<`立即手机付款（10分钟内有效）

#### 6. **备选方案**

- **多设备协作**：
    - 主电脑运行脚本
    - 备用手机同时手动抢票（不同网络，如5G热点）
- **代理IP（可选）**：

#### 注意事项

1. **网络优先级**：
    - 企业宽带 > 家庭宽带 > 手机热点
    - 避免使用公共WiFi

2. **系统时间校准**：
   ```bash
   # Windows同步时间
   w32tm /resync
   ```

3. **典型失败原因**：
    - access_token过期（必须抢票前2小时内获取）
    - Fiddler未关闭（占用端口8080）
    - 电脑进入睡眠模式

> 成功率公式：**脚本质量(40%) + 网络延迟(30%) + 时间控制(20%) + 运气(10%)**  
> 建议首次抢票用非热门场次测试，熟悉流程后再抢热门场次。
> 本文档仅将技术细节整合传播，抢票成功率与个人能力、运气、环境等因素有关，请勿对号入座。
> 本程序仅供学习交流，如非法商用，一切后果自负。